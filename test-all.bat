@echo off
chcp 65001 > nul
cls

echo üß™ –ö–û–ú–ü–õ–ï–ö–°–ù–û–ï –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ò–°–¢–û–†–ò–ß–ï–°–ö–û–ì–û –ü–û–†–¢–†–ï–¢–ê v2.0
echo ========================================================

echo.
echo üìã –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞...

REM –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
if not exist "index-v2.html" (
    echo ‚ùå index-v2.html –Ω–µ –Ω–∞–π–¥–µ–Ω
    goto :error
)
if not exist "index-server.html" (
    echo ‚ùå index-server.html –Ω–µ –Ω–∞–π–¥–µ–Ω
    goto :error
)
if not exist "server.py" (
    echo ‚ùå server.py –Ω–µ –Ω–∞–π–¥–µ–Ω
    goto :error
)
if not exist "requirements.txt" (
    echo ‚ùå requirements.txt –Ω–µ –Ω–∞–π–¥–µ–Ω
    goto :error
)

echo ‚úÖ –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã –Ω–∞–π–¥–µ–Ω—ã

echo.
echo üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ Python...

REM –ü—Ä–æ–≤–µ—Ä—è–µ–º Python
python --version >nul 2>&1
if errorlevel 1 (
    echo ‚ùå Python –Ω–µ –Ω–∞–π–¥–µ–Ω
    goto :error
)

echo ‚úÖ Python –Ω–∞–π–¥–µ–Ω

echo.
echo üì¶ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...

REM –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
python -c "import flask" >nul 2>&1
if errorlevel 1 (
    echo ‚ö†Ô∏è  Flask –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
    echo üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...
    pip install -r requirements.txt
    if errorlevel 1 (
        echo ‚ùå –û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
        goto :error
    )
)

python -c "import cv2" >nul 2>&1
if errorlevel 1 (
    echo ‚ö†Ô∏è  OpenCV –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
    echo üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ OpenCV...
    pip install opencv-python
)

echo ‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≥–æ—Ç–æ–≤—ã

echo.
echo üåê –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞...

REM –ó–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–µ—Ä –≤ —Ñ–æ–Ω–µ
echo üöÄ –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞...
start /B python server.py

REM –ñ–¥–µ–º –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
timeout /t 3 /nobreak >nul

REM –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞
curl -s http://localhost:5000/health >nul 2>&1
if errorlevel 1 (
    echo ‚ùå –°–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
    goto :error
)

echo ‚úÖ –°–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç

echo.
echo üì± –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤...

REM –û—Ç–∫—Ä—ã–≤–∞–µ–º –∫–ª–∏–µ–Ω—Ç—Å–∫—É—é –≤–µ—Ä—Å–∏—é
echo üñ•Ô∏è  –û—Ç–∫—Ä—ã—Ç–∏–µ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –≤–µ—Ä—Å–∏–∏...
start index-v2.html

REM –ñ–¥–µ–º
timeout /t 2 /nobreak >nul

REM –û—Ç–∫—Ä—ã–≤–∞–µ–º —Å–µ—Ä–≤–µ—Ä–Ω—É—é –≤–µ—Ä—Å–∏—é
echo üåê –û—Ç–∫—Ä—ã—Ç–∏–µ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –≤–µ—Ä—Å–∏–∏...
start index-server.html

echo.
echo ‚úÖ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û
echo.
echo üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:
echo    ‚úÖ –í—Å–µ —Ñ–∞–π–ª—ã –Ω–∞–π–¥–µ–Ω—ã
echo    ‚úÖ Python —Ä–∞–±–æ—Ç–∞–µ—Ç
echo    ‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
echo    ‚úÖ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω
echo    ‚úÖ –ö–ª–∏–µ–Ω—Ç—ã –æ—Ç–∫—Ä—ã—Ç—ã
echo.
echo üéØ –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:
echo    1. üì± –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–æ–ª–µ–π –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
echo    2. üì∏ –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
echo    3. üé® –°–æ–∑–¥–∞–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –ø–æ—Ä—Ç—Ä–µ—Ç–æ–≤
echo    4. üíæ –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
echo    5. üì§ –§—É–Ω–∫—Ü–∏—è "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è"
echo.
echo üåê –°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:5000
echo üì± –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –≤–µ—Ä—Å–∏—è: index-v2.html
echo üåê –°–µ—Ä–≤–µ—Ä–Ω–∞—è –≤–µ—Ä—Å–∏—è: index-server.html
echo.

pause
exit /b 0

:error
echo.
echo ‚ùå –û–®–ò–ë–ö–ê –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø
echo.
echo üîß –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:
echo    1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ –º–µ—Å—Ç–µ
echo    2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Python 3.7+
echo    3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ: pip install -r requirements.txt
echo    4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ—Ä—Ç 5000 —Å–≤–æ–±–æ–¥–µ–Ω
echo.
pause
exit /b 1
